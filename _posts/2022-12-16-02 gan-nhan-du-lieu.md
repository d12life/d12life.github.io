---
layout: post
author: d12life
title: BÃ i 5 - GÃ¡n nhÃ£n dá»¯ liá»‡u vÃ  cÃ´ng cá»¥ sá»­ dá»¥ng
---
Äá»ƒ cÃ³ dá»¯ liá»‡u sáº¡ch vÃ  cÃ³ giÃ¡ trá»‹ Ä‘á»‘i vá»›i cÃ¡c thuáº­t toÃ¡n thÃ¬ dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c gÃ¡n nhÃ£n vÃ  chÃº giáº£i bá»Ÿi con ngÆ°á»i. DÆ°á»›i Ä‘Ã¢y lÃ  gá»£i Ã½ vá» má»™t sá»‘ loáº¡i chÃº giáº£i cho dá»¯ liá»‡u hÃ¬nh áº£nh vÃ  cÃ¡c Ä‘á»‹nh dáº¡ng khÃ¡c nhau cá»§a nhÃ£n.

# 1. Táº§m quan trá»ng cá»§a gÃ¡n nhÃ£n dá»¯ liá»‡u
Náº¿u báº¡n Ä‘Æ°a cho Ä‘á»©a tráº» má»™t quáº£ cÃ  chua vÃ  nÃ³i ráº±ng Ä‘Ã¢y lÃ  cá»§ khoai tÃ¢y, thÃ¬ nhá»¯ng láº§n sau Ä‘Ã³, khi nhÃ¬n tháº¥y cÃ  chua, ráº¥t cÃ³ thá»ƒ Ä‘á»©a tráº» sáº½ phÃ¢n loáº¡i Ä‘Ã³ lÃ  khoai tÃ¢y. Äiá»u nÃ y tÆ°Æ¡ng tá»± Ä‘á»‘i vá»›i viá»‡c gÃ¡n nhÃ£n dá»¯ liá»‡u trong há»c mÃ¡y cÃ³ giÃ¡m sÃ¡t. Bá»Ÿi mÃ´ hÃ¬nh há»c mÃ¡y cÅ©ng há»c theo cÃ¡ch nhÆ° váº­y, báº±ng cÃ¡ch xem xÃ©t cÃ¡c vÃ­ dá»¥, káº¿t quáº£ cá»§a mÃ´ hÃ¬nh phá»¥ thuá»™c vÃ o cÃ¡c nhÃ£n dá»¯ liá»‡u Ä‘Æ°á»£c cung cáº¥p trong giai Ä‘oáº¡n Ä‘Ã o táº¡o.

Garbage In Garbage Out lÃ  má»™t cá»¥m tá»« thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cá»™ng Ä‘á»“ng há»c mÃ¡y, cÃ³ nghÄ©a lÃ  cháº¥t lÆ°á»£ng cá»§a dá»¯ liá»‡u Ä‘Ã o táº¡o quyáº¿t Ä‘á»‹nh Ä‘áº¿n cháº¥t lÆ°á»£ng cá»§a mÃ´ hÃ¬nh, do Ä‘Ã³, cÅ©ng phá»¥ thuá»™c vÃ o cÃ¡c chÃº thÃ­ch Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gÃ¡n nhÃ£n dá»¯ liá»‡u. ÄÃ¢y lÃ  má»™t cÃ´ng viá»‡c Ä‘Ã²i há»i nhiá»u thao tÃ¡c thá»§ cÃ´ng. Äá»ƒ cÃ³ dá»¯ liá»‡u sáº¡ch vÃ  cÃ³ giÃ¡ trá»‹ Ä‘á»‘i vá»›i cÃ¡c thuáº­t toÃ¡n thÃ¬ dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c gÃ¡n nhÃ£n vÃ  chÃº giáº£i bá»Ÿi con ngÆ°á»i. DÆ°á»›i Ä‘Ã¢y lÃ  gá»£i Ã½ vá» má»™t sá»‘ loáº¡i chÃº giáº£i cho dá»¯ liá»‡u hÃ¬nh áº£nh, cÃ¡c Ä‘á»‹nh dáº¡ng khÃ¡c nhau cá»§a nhÃ£n, nháº±m giÃºp báº¡n cÃ³ Ä‘Æ°á»£c lá»±a chá»n phÃ¹ há»£p vÃ  hoÃ n thÃ nh tá»‘t tÃ¡c vá»¥ gÃ¡n nhÃ£n dá»¯ liá»‡u.

# 2. CÃ¡c loáº¡i chÃº giáº£i cho dá»¯ liá»‡u áº£nh
**Bounding boxes**: lÃ  loáº¡i chÃº thÃ­ch Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n nháº¥t trong thá»‹ giÃ¡c mÃ¡y tÃ­nh. Bounding boxes lÃ  cÃ¡c há»™p hÃ¬nh chá»¯ nháº­t dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a Ä‘á»‘i tÆ°á»£ng má»¥c tiÃªu. ChÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng tá»a Ä‘á»™ trá»¥c ğ‘¥ vÃ  ğ‘¦ á»Ÿ gÃ³c trÃªn bÃªn trÃ¡i vÃ   gÃ³c dÆ°á»›i bÃªn pháº£i cá»§a hÃ¬nh chá»¯ nháº­t. Há»™p giá»›i háº¡n thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c nhiá»‡m vá»¥ phÃ¡t hiá»‡n vÃ  khoanh vÃ¹ng Ä‘á»‘i tÆ°á»£ng. 

![image](/assets/images/lesson_5/bd-box.jpeg.webp)

Bounding boxes thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng hai tá»a Ä‘á»™ (x1, y1) vÃ  (x2, y2) hoáº·c bá»Ÿi má»™t tá»a Ä‘á»™ (x1, y1) vÃ  chiá»u rá»™ng (w) vÃ  chiá»u cao (h) cá»§a há»™p.

**Polygonal Segmentation** (PhÃ¢n Ä‘oáº¡n Ä‘a giÃ¡c): CÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng pháº£i lÃºc nÃ o cÅ©ng cÃ³ dáº¡ng hÃ¬nh chá»¯ nháº­t. Vá»›i Ã½ tÆ°á»Ÿng nÃ y, phÃ¢n Ä‘oáº¡n Ä‘a giÃ¡c lÃ  má»™t loáº¡i chÃº thÃ­ch dá»¯ liá»‡u khÃ¡c trong Ä‘Ã³ cÃ¡c Ä‘a giÃ¡c phá»©c táº¡p Ä‘Æ°á»£c sá»­ dá»¥ng thay vÃ¬ hÃ¬nh chá»¯ nháº­t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh hÃ¬nh dáº¡ng vÃ  vá»‹ trÃ­ cá»§a Ä‘á»‘i tÆ°á»£ng má»™t cÃ¡ch chÃ­nh xÃ¡c.

![image](/assets/images/lesson_5/1_mvAz7lcEqusO24AyXyIxLQ.png.webp)

**Semantic Segmentation** (PhÃ¢n Ä‘oáº¡n theo ngá»¯ nghÄ©a): lÃ  má»™t chÃº thÃ­ch pixel, trong Ä‘Ã³ má»—i pixel trong hÃ¬nh áº£nh Ä‘Æ°á»£c gÃ¡n cho má»™t lá»›p. Má»—i pixel mang má»™t Ã½ nghÄ©a khÃ¡c nhau. PhÃ¢n Ä‘oáº¡n ngá»¯ nghÄ©a chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng trong trÆ°á»ng há»£p bá»‘i cáº£nh mÃ´i trÆ°á»ng lÃ  ráº¥t quan trá»ng. VÃ­ dá»¥, nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng trong Ã´ tÃ´ tá»± lÃ¡i vÃ  robot Ä‘á»ƒ giÃºp cÃ¡c mÃ´ hÃ¬nh hiá»ƒu rÃµ Ä‘Æ°á»£c mÃ´i trÆ°á»ng mÃ  chÃºng Ä‘ang hoáº¡t Ä‘á»™ng. 

![image](/assets/images/lesson_5/Semantic-segmentation.webp)

**Instance segmentation**: KhÃ¡c vá»›i Semantic Segmentation (phÃ¢n Ä‘oáº¡n theo tá»«ng lá»›p), instance segmentation lÃ  cÃ¡ch phÃ¢n Ä‘oáº¡n cÃ¡c vÃ¹ng áº£nh chi tiáº¿t Ä‘áº¿n tá»«ng Ä‘á»‘i tÆ°á»£ng trong má»—i nhÃ£n. VÃ­ dá»¥, náº¿u trong áº£nh cÃ³ 5 ngÆ°á»i, thÃ¬ vá»›i cÃ¡ch phÃ¢n Ä‘oáº¡n nÃ y, sáº½ cÃ³ 5 vÃ¹ng khÃ¡c nhau cho má»—i ngÆ°á»i. 

**HÃ¬nh khá»‘i 3D**: HÃ¬nh khá»‘i 3D tÆ°Æ¡ng tá»± nhÆ° cÃ¡c há»™p giá»›i háº¡n vá»›i thÃ´ng tin sÃ¢u hÆ¡n vá» Ä‘á»‘i tÆ°á»£ng. Do Ä‘Ã³, vá»›i hÃ¬nh khá»‘i 3D, báº¡n cÃ³ thá»ƒ cÃ³ Ä‘Æ°á»£c hÃ¬nh áº£nh Ä‘áº¡i diá»‡n 3D cá»§a Ä‘á»‘i tÆ°á»£ng, cho phÃ©p há»‡ thá»‘ng phÃ¢n biá»‡t cÃ¡c tÃ­nh nÄƒng nhÆ° thá»ƒ tÃ­ch vÃ  vá»‹ trÃ­ trong khÃ´ng gian 3D. Má»™t trÆ°á»ng há»£p sá»­ dá»¥ng cá»§a hÃ¬nh khá»‘i 3D lÃ  trong Ã´ tÃ´ tá»± lÃ¡i, nÆ¡i sá»­ dá»¥ng thÃ´ng tin vá» Ä‘á»™ sÃ¢u Ä‘á»ƒ Ä‘o khoáº£ng cÃ¡ch cá»§a cÃ¡c váº­t thá»ƒ tá»« Ã´ tÃ´.

![image](/assets/images/lesson_5/3d.webp)

**Key-Point and Landmark**: ChÃº thÃ­ch Key-Point and Landmark Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¡t hiá»‡n cÃ¡c Ä‘á»‘i tÆ°á»£ng nhá» vÃ  cÃ¡c biáº¿n thá»ƒ hÃ¬nh dáº¡ng báº±ng cÃ¡ch táº¡o cÃ¡c cháº¥m trÃªn hÃ¬nh áº£nh. Loáº¡i chÃº thÃ­ch nÃ y ráº¥t há»¯u Ã­ch Ä‘á»ƒ phÃ¡t hiá»‡n cÃ¡c Ä‘áº·c Ä‘iá»ƒm khuÃ´n máº·t, nÃ©t máº·t, cáº£m xÃºc, cÃ¡c bá»™ pháº­n cÆ¡ thá»ƒ ngÆ°á»i vÃ  tÆ°

![image](/assets/images/lesson_5/key-point.webp)

**Lines and Splines**: lÃ  chÃº thÃ­ch Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c lines vÃ  splines. NÃ³ thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c phÆ°Æ¡ng tiá»‡n tá»± hÃ nh Ä‘á»ƒ phÃ¡t hiá»‡n vÃ  nháº­n dáº¡ng lÃ n Ä‘Æ°á»ng.

![image](/assets/images/lesson_5/line.webp)

# 3. CÃ¡c Ä‘á»‹nh dáº¡ng gÃ¡n nhÃ£n cho dá»¯ liá»‡u áº£nh
- COCO: COCO cÃ³ nÄƒm loáº¡i chÃº thÃ­ch: phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng, phÃ¡t hiá»‡n Ä‘iá»ƒm chÃ­nh, phÃ¢n Ä‘oáº¡n ná»™i dung, phÃ¢n Ä‘oáº¡n toÃ n cáº£nh vÃ  chÃº thÃ­ch hÃ¬nh áº£nh. CÃ¡c chÃº thÃ­ch Ä‘Æ°á»£c lÆ°u trá»¯ báº±ng JSON.
- Pascal VOC: Pascal VOC lÆ°u trá»¯ chÃº thÃ­ch trong tá»‡p XML. 
- YOLO: á» Ä‘á»‹nh dáº¡ng ghi nhÃ£n YOLO, má»™t tá»‡p .txt cÃ³ cÃ¹ng tÃªn Ä‘Æ°á»£c táº¡o cho má»—i tá»‡p hÃ¬nh áº£nh trong cÃ¹ng má»™t thÆ° má»¥c. Má»—i tá»‡p .txt chá»©a cÃ¡c chÃº thÃ­ch cho tá»‡p hÃ¬nh áº£nh tÆ°Æ¡ng á»©ng, Ä‘Ã³ lÃ  lá»›p Ä‘á»‘i tÆ°á»£ng, tá»a Ä‘á»™ Ä‘á»‘i tÆ°á»£ng, chiá»u cao vÃ  chiá»u rá»™ng (<object-class> <x> <y> <width> <height>).

# 4. HÆ°á»›ng dáº«n sá»­ dá»¥ng cÃ´ng cá»¥ **labelImg**
**LabelImg** lÃ  má»™t cÃ´ng cá»¥ annotation Ä‘Æ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ Python vÃ  sá»­ dá»¥ng Qt cho giao diá»‡n Ä‘á»“ há»a.

Annotations Ä‘Æ°á»£c lÆ°u theo Ä‘á»‹nh dáº¡ng XML cá»§a PASCAL VOC (Ä‘á»‹nh dáº¡ng Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi ImageNet). BÃªn cáº¡nh Ä‘Ã³ nÃ³ cÅ©ng há»— trá»£ Ä‘á»‹nh dáº¡ng YOLO vÃ  CreateML.
![image](/assets/images/lesson_5/labelImg1.jpg)

# 4.1 CÃ i Ä‘áº·t trÃªn mÃ´i trÆ°á»ng Windows
- **BÆ°á»›c 1**: CÃ¡c báº¡n clone source code tá»« repo: https://github.com/tzutalin/labelImg.
- **BÆ°á»›c 2**: CÃ i Ä‘áº·t python (náº¿u trÃªn mÃ¡y Ä‘Ã£ cÃ³ cÃ i sáºµn python thÃ¬ bá» qua bÆ°á»›c nÃ y)
- **BÆ°á»›c 3**: CÃ i PyQt5 báº±ng cmd
```
pip install PyQt5
```
- **BÆ°á»›c 4**: CÃ i lxml
```
pip install lxml
```
- **BÆ°á»›c 5**: Copy cÃ¡c file cáº§n thiáº¿t báº±ng cmd
```
pyrcc5 -o libs/resources.py resources.qrc
```
Váº­y lÃ  xong, cháº¡y file labelImg.py Ä‘á»ƒ báº¯t Ä‘áº§u gÃ¡n nhÃ£n cho áº£nh.

## 4.2 GÃ¡n nhÃ£n theo Ä‘á»‹nh dáº¡ng PascalVOC
1. Cháº¡y file labelImg.py Ä‘á»ƒ launch chÆ°Æ¡ng trÃ¬nh.
2. Nháº¥p â€˜Change default saved annotation folderâ€™ trÃªn Menu/File
3. Nháº¥p â€˜Open Dirâ€™
4. Nháº¥p â€˜Create RectBoxâ€™
5. Nháº¥p vÃ  nháº£ chuá»™t trÃ¡i Ä‘á»ƒ chá»n vÃ¹ng cáº§n annotate cho rect box
6. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng chuá»™t pháº£i Ä‘á»ƒ kÃ©o rect box Ä‘á»ƒ sao chÃ©p hoáº·c di chuyá»ƒn nÃ³.

Annotation sáº½ Ä‘Æ°á»£c lÆ°u vÃ o thÆ° má»¥c báº¡n Ä‘Ã£ chá»‰ Ä‘á»‹nh.

## 4.3 GÃ¡n nhÃ£n theo Ä‘á»‹nh dáº¡ng YOLO
1. Trong thÆ° má»¥c `data/predefined_classes.txt` Ä‘á»‹nh nghÄ©a danh sÃ¡ch cÃ¡c lá»›p sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ training.
2. Cháº¡y file labelImg.py Ä‘á»ƒ launch chÆ°Æ¡ng trÃ¬nh.
3. Nháº¥p vÃ o nÃºt â€œPascalVOCâ€ ngay bÃªn dÆ°á»›i nÃºt â€œSaveâ€ trÃªn toolbar Ä‘á»ƒ chuyá»ƒn sang Ä‘á»‹nh dáº¡ng YOLO.
4. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Open/OpenDIR Ä‘á»ƒ xá»­ lÃ½ má»™t hoáº·c nhiá»u áº£nh. Khi xá»­ lÃ½ xong má»™t áº£nh, nháº¥p save.

Má»™t file txt theo Ä‘á»‹nh dáº¡ng YOLO cÃ¹ng tÃªn vá»›i file áº£nh vÃ  má»™t file cÃ³ tÃªn â€œclasses.txtâ€ sáº½ Ä‘Æ°á»£c lÆ°u trong cÃ¹ng thÆ° má»¥c chá»©a áº£nh. â€œclasses.txtâ€ Ä‘á»‹nh nghÄ©a danh sÃ¡ch tÃªn lá»›p YOLO label tham chiáº¿u.

***LÆ°u Ã½***: 
- Danh sÃ¡ch label cá»§a chÃºng ta khÃ´ng nÃªn thay Ä‘á»•i trong quÃ¡ trÃ¬nh gÃ¡n nhÃ£n. Khi chÃºng ta lÆ°u má»™t áº£nh, classes.txt sáº½ Ä‘Æ°á»£c update, trong khi annotations trÆ°á»›c Ä‘Ã³ sáº½ khÃ´ng Ä‘Æ°á»£c update.
- ChÃºng ta khÃ´ng nÃªn sá»­ dá»¥ng chá»©c nÄƒng â€œdefault classâ€ khi lÆ°u áº£nh vá»›i Ä‘á»‹nh dáº¡ng YOLO, nÃ³ sáº½ khÃ´ng Ä‘Æ°á»£c tham chiáº¿u.
- Khi lÆ°u vá»›i Ä‘á»‹nh dáº¡ng YOLO, cá» â€œdifficultâ€ bá»‹ bá» qua.

## 4.4. Táº¡o cÃ¡c lá»›p pre-defined
ChÃºng ta cÃ³ thá»ƒ edit file [data/predefined_classes.txt](https://github.com/heartexlabs/labelImg/blob/master/data/predefined_classes.txt) Ä‘á»ƒ load cÃ¡c lá»›p pre-defined.

## 4.5 Hotkeys

| Ctrl + u         | Load all of the images from a directory   |
| ---------------- | ----------------------------------------- |
| Ctrl + r         | Change the default annotation target dir  |
| Ctrl + s         | Save                                      |
| Ctrl + d         | Copy the current label and rect box       |
| Ctrl + Shift + d | Delete the current image                  |
| Space            | Flag the current image as verified        |
| w                | Create a rect box                         |
| d                | Next image                                |
| a                | Previous image                            |
| del              | Delete the selected rect box              |
| Ctrl++           | Zoom in                                   |
| Ctrlâ€“            | Zoom out                                  |
| â†‘â†’â†“â†             | Keyboard arrows to move selected rect box |

## 4.6 Verify Image
Khi nháº¥n phÃ­m cÃ¡ch, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Ã¡nh dáº¥u áº£nh Ä‘Ã£ xÃ¡c minh, ná»n xanh sáº½ xuáº¥t hiá»‡n. Äiá»u nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng khi táº¡o táº­p dá»¯ liá»‡u tá»± Ä‘á»™ng, sau Ä‘Ã³ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ xem qua táº¥t cáº£ cÃ¡c áº£nh vÃ  gáº¯n cá» cho chÃºng thay vÃ¬ chÃº thÃ­ch chÃºng.

## 4.7 Difficult
TrÆ°á»ng difficult Ä‘Æ°á»£c Ä‘áº·t thÃ nh 1 cho biáº¿t Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ Ä‘Æ°á»£c chÃº thÃ­ch lÃ  "difficult", vÃ­ dá»¥: má»™t Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ nhÃ¬n tháº¥y rÃµ rÃ ng nhÆ°ng khÃ³ nháº­n ra náº¿u khÃ´ng sá»­ dá»¥ng ngá»¯ cáº£nh Ä‘Ã¡ng ká»ƒ. Theo cÃ¡ch triá»ƒn khai máº¡ng lÆ°á»›i tháº§n kinh sÃ¢u cá»§a báº¡n, báº¡n cÃ³ thá»ƒ bao gá»“m hoáº·c loáº¡i trá»« cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ³ trong quÃ¡ trÃ¬nh Ä‘Ã o táº¡o.

## 4.8 How to reset the settings
Trong trÆ°á»ng há»£p cÃ³ issue trong khi load cÃ¡c lá»›p (classes), chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n má»™t trong 2 cÃ¡ch:
1. Nháº¥n Menu/File/Reset All
2. Remove the .labelImgSettings.pkl from your home directory. In Linux and Mac you can do:
rm ~/.labelImgSettings.pkl

# 5. Tham kháº£o
1. https://blog.vinbigdata.org/garbage-in-garbage-out-tu-goc-do-gan-nhan-du-lieu/
2. https://pypi.org/project/labelImg/